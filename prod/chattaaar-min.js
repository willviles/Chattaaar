!function(t,i,e,s){var a=function(i,e,s){this.elem=i,this.$elem=t(i),this.options=e,this.stages=s,this.store={}};a.prototype={init:function(){return this.options=t.extend({formName:"form-"+(1+Math.floor(1e3*Math.random())),yourName:"Us",theirName:"You",welcomeTitle:'<i class="el-icon-envelope"></i>',welcomeText:"Welcome",welcomeStrapline:"Please add a strapline",startBtnText:"Start",nextBtnText:"Next",sendBtnText:"Send",skipBtnText:"Skip",modal:!1,modalOpenBtn:".chattaaar-open",modalContainer:".chattaaar-modal",modalFullScreen:!1,testMode:!1},options),this.setup.main.call(this),this.scaffold.main.call(this),this.scaffold.welcome.call(this),this.setup.stages.call(this),this.links.init.call(this),this.utilities.init.call(this),!this.options.modal==!1&&this.utilities.initModal.call(this),this},setup:{main:function(){console.log(this),this.$elem.attr({name:options.formName,action:options.formAction}),"undefined"!=typeof options.theme&&this.$elem.addClass(this.options.theme)},stages:function(){for(this.stage=1,this.stages=stages,this.stagesLength=Object.keys(this.stages).length,this.sss=0,this.sss=1;this.sss<this.stagesLength+1;this.sss++){var t=this.stages["stage"+this.sss];"input"===t.type?this.append.input.call(this,t,t.type):"email"===t.type?this.append.input.call(this,t,t.type):"textarea"===t.type?this.append.textarea.call(this,t):"select"===t.type?this.append.select.call(this,t):"checkbox"===t.type||"radio"===t.type?this.append.checkboxradio.call(this,t):"date"===t.type?this.append.input.call(this,t,t.type):"rating"===t.type?this.append.rating.call(this,t):"media"===t.type?this.append.input.call(this,t,t.type):console.log("Error: Stage #"+this.sss+" has no valid 'type' set."),this.store[t.inputName]=""}this.$elem.append('<div class="ch-sending"><h2 class="alert-text"><i class="el-icon-envelope"></i> Sending...</h2></div>')},focus:function(){function t(){i=!1,setTimeout(function(){i=!0},1e3)}var i=!0,e=this.$elem.find("section:nth-of-type("+this.stage+")"),s=this,a=e.find("input"),n=e.find("textarea"),l=e.find("select"),o=e.find(".ch-next");n.length>0?a=n:l.length>0&&(a=l),a.length>0||n.length>0||l.length>0?(a.focus(),a.unbind("keydown").bind("keydown",function(e){i===!1&&e.preventDefault(),9===e.keyCode?(e.preventDefault(),o.hasClass("validated")&&o.focus()):13===e.keyCode&&i===!0&&(e.preventDefault(),s.links.nextStage.call(s,o),a.blur(),o.blur(),t())}),o.bind("keydown",function(t){9===t.which&&(t.preventDefault(),a.focus())})):(o.focus(),o.unbind("keydown").bind("keydown",function(e){i===!1&&e.preventDefault(),13===e.keyCode&&i&&(e.preventDefault(),s.links.nextStage.call(s,o),o.blur(),t())})),e.find(".checkbox-radio").on("click",function(){o.focus()})}},scaffold:{main:function(){var t='<div class="ch-title"><span>'+options.welcomeTitle+"</span></div>",i='<div class="ch-counter"><span>-</span></div>',e="",s="",a="",n="";this.options.modal&&(e='<div class="ch-close"><i class="el-icon-remove"></i></div>'),s='<div class="chattaaar-topbar">'+t+i+e+" </div>",this.$elem.append(s),this.options.modal&&(n=this.options.modalContainer,n=n.replace(/\./g,""),"undefined"!=typeof this.options.theme&&(a=" "+options.theme),this.$elem.wrap('<div class="chattaaar-modal '+n+a+'"></div>'))},stage:function(t,i){var e,s;this.stagesLength=Object.keys(this.stages).length,e=this.sss===this.stagesLength?this.options.sendBtnText:i.skippable===!0?this.options.skipBtnText:this.options.nextBtnText,s=i.skippable===!0?'<button type="button" class="ch-next skip validated">'+e+"</button>":'<button type="button" class="ch-next">'+e+"</button>";var a='<div class="default-icon"><i class="el-icon-child"></i></div>',n="",l=a,o="",c=a;"undefined"!=typeof i.useDifferentPerson?"undefined"!=typeof i.useDifferentPerson.avatar&&(l="",n=i.useDifferentPerson.avatar):"undefined"!=typeof this.options.yourAvatar&&(l="",n=this.options.yourAvatar),"undefined"!=typeof this.options.theirAvatar&&(c="",o=this.options.theirAvatar);var d;"undefined"!=typeof i.useDifferentPerson?"undefined"!=typeof i.useDifferentPerson.name&&(d=i.useDifferentPerson.name):d=this.options.yourName;var h='<section>             <div class="section-padding">               <div class="question-container">                 <div class="person-icon" style="background-image: url('+n+');">                   '+l+'                   <span class="name"><small>'+d+"</small></span>                 </div>                 <p>                   <span>"+i.question+'</span>                 </p>               </div>               <div class="action-container">                 <div class="person-icon" style="background-image: url('+this.options.theirAvatar+');">                   '+c+'                   <span class="name"><small>'+this.options.theirName+'</small></span>                 </div>                 <div class="action-wrapper">'+t+'</div>                 <div class="ch-btns-container">                   '+s+'                   <button type="button" class="ch-prev"><small><i class="el-icon-caret-up"></i></small> Prev</button>                 </div>               </div>             </div>           </section>';return h},welcome:function(){var t="";"undefined"!=typeof this.options.welcomeImage&&(t='<div style="background-image: url('+this.options.welcomeImage+"); height: "+this.options.welcomeImageHeight+"; width: "+this.options.welcomeImageWidth+"; background-size: "+this.options.welcomeImageWidth+" "+this.options.welcomeImageHeight+';" class="welcome-image"></div>'),this.$elem.append('           <section class="welcome active">             <div class="section-padding">               '+t+"               <h2>"+this.options.welcomeText+"</h2>               <p>"+this.options.welcomeStrapline+'</p>               <div class="ch-next validated"><h4>'+this.options.startBtnText+"</h4></div>             </div>           </section>")}},append:{input:function(i,e){var s,a="",n,l;if("media"===e){var o=i.accepts;t.each(o,function(t,i){a=a+" data-"+i+'="true"'}),e="text",s="ch-media"}"date"===e&&(e="text",s="ch-datepicker");var c='<input type="'+e+'" name="'+i.inputName+'" placeholder="'+i.placeholder+'" class="'+s+'" autocomplete="off"'+a+">";this.$elem.append(this.scaffold.stage.call(this,c,i))},textarea:function(t){var i="",e="",a=function(t){return'<div class="limit-update"><p><span class="limit-count">0</span>/'+t+"</p></div>"};t.charlimit!==s?(i='data-charlimit="'+t.charlimit+'"',e=a(t.charlimit)):t.wordlimit!==s&&(i='data-wordlimit="'+t.wordlimit+'"',e=a(t.wordlimit));var n='<textarea name="'+t.inputName+'" placeholder="'+t.placeholder+'"'+i+"></textarea>"+e;this.$elem.append(this.scaffold.stage.call(this,n,t))},checkboxradio:function(i){var e="";t.each(i.options,function(t,s){var a='             <label class="checkbox-radio">               <input type="'+i.type+'" name="'+i.inputName+'" value="'+s+'"/>               <span>                 <i class="el-icon-check-empty"></i>                 <i class="el-icon-edit"></i>                 <i class="el-icon-check"></i>                 '+s+"               </span>             </label>";e+=a}),e='<div class="checkbox-group">'+e+"</div>",this.$elem.append(this.scaffold.stage.call(this,e,i))},select:function(i){var e="";t.each(i.options,function(t,i){var s="<option>"+i+"</option>";e+=s});var s='           <select type="text" name="'+i.inputName+'" placeholder="'+i.placeholder+'">             <option value="" disabled selected>'+i.placeholder+"</option>             "+e+"           </select>";this.$elem.append(this.scaffold.stage.call(this,s,i))},rating:function(t){var i='<input type="hidden" name="'+t.inputName+'">',e='<li><i class="star el-icon-star"></i></li>',s='<span class="star-count"></span>',a='<ul class="rating rating-'+t.inputName+'">'+e+e+e+e+e+s+i+"</ul>";this.$elem.append(this.scaffold.stage.call(this,a,t))}},links:{nextStage:function(t){if(t.hasClass("validated"))if(this.stage===this.stagesLength+1)this.send.call(this);else{this.$elem.find("section:nth-of-type("+this.stage+")").removeClass("active").addClass("after"),this.$elem.find("section:nth-of-type("+(this.stage+1)+")").addClass("active"),this.stage++,this.utilities.changeTitle.call(this);var i=this;this.utilities.isMobile()||setTimeout(function(){i.setup.focus.call(i)},500),this.validations.validate.call(this)}},previousStage:function(t){this.$elem.find("section:nth-of-type("+this.stage+")").removeClass("active"),this.$elem.find("section:nth-of-type("+(this.stage-1)+")").removeClass("after").addClass("active"),this.stage--,this.utilities.changeTitle.call(this);var i=this;this.utilities.isMobile()||setTimeout(function(){i.setup.focus.call(i)},500),this.validations.validate.call(this)},init:function(){var i=this;this.$elem.find(".ch-next").on("click",function(e){e.preventDefault(),i.links.nextStage.call(i,t(this))}),this.$elem.find(".ch-prev").on("click",function(e){e.preventDefault(),i.links.previousStage.call(i,t(this))})}},validations:{makeValid:function(t){t.hasClass("skip")?t.html("Next"):t.addClass("validated")},makeInvalid:function(t){t.hasClass("skip")?t.html("Skip"):t.removeClass("validated")},validate:function(){var i=this.$elem.find("section:nth-of-type("+this.stage+")"),e=i.find("input, textarea"),s=i.find("select"),a=i.find(".checkbox-group"),n=i.find(".rating"),l=i.find(".ch-datepicker"),o=i.find(".ch-next"),c=this;e.keyup(function(){var i=t(this),s=i.attr("name"),a=i.val(),n=e.filter(function(){return""===t.trim(this.value)});n.length?(c.validations.makeInvalid(o),(i.is("[data-charlimit]")||i.is("[data-wordlimit]"))&&c.validations.types.limit.call(c,a,i,o)):"email"===i.attr("type")?c.validations.types.email.call(c,a,o):i.hasClass("ch-datepicker")?c.validations.types.date(value):i.hasClass("ch-media")?c.validations.types.media.call(c,a,i,o):i.is("[data-charlimit]")||i.is("[data-wordlimit]")?c.validations.types.limit.call(c,a,i,o):c.validations.makeValid(o),c.store[s]=a,t("span.ch-"+s).html(a)}),s.each(function(){c.validations.types.select.call(c,t(this),o)}),a.on("click",function(){c.validations.types.checkboxradio.call(c,t(this),o)}),n.length>0&&this.plugins.rating.init.call(this),l.length>0&&this.plugins.date.init.call(this,l)},types:{email:function(t,i){var e=/^[A-Z0-9._%+-]+@([A-Z0-9-]+\.)+[A-Z]{2,4}$/i;e.test(t)?this.validations.makeValid(i):this.validations.makeInvalid(i)},select:function(i,e){var s=this;i.change(function(){s.validations.makeValid(e);var i=t(this).attr("name"),a=t(this).val();s.store[i]=a,t("span.ch-"+i).html(a)})},checkboxradio:function(t,i){var e=t.find("input:checked");e.length>0?this.validations.makeValid(i):this.validations.makeInvalid(i)},media:function(t,i,e){if(i.is("[data-youtube]")||i.is("[data-soundcloud]")){var s=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,a=/^https?:\/\/(soundcloud.com|snd.sc)\/(.*)$/;s.test(t)||a.test(t)?this.validations.makeValid(e):this.validations.makeInvalid(e)}},limit:function(t,i,e){var a=i.attr("data-charlimit"),n=i.attr("data-wordlimit"),l=i.closest(".action-wrapper").find(".limit-update"),o=l.find(".limit-count"),c=t.length,d=t.split(" "),h=d.length-1;a!==s?o.html(c):n!==s&&o.html(h),a>=c||n>=h?(l.removeClass("invalid"),this.validations.makeValid(e)):(l.addClass("invalid"),this.validations.makeInvalid(e))}}},plugins:{rating:{init:function(){var i=this.$elem.find("section:nth-of-type("+this.stage+")"),e=i.find(".rating"),s=e.find("li"),a=i.find(".ch-next"),n=this;s.unbind("mouseenter mouseleave").bind("mouseenter",function(){if(!e.hasClass("valueSelected")){e.find("li").removeClass("hover");for(var i=t(this).index(),s=1;i+1>=s;s++)e.find("li:nth-child("+s+")").addClass("hover")}}),e.unbind("mouseenter mouseleave").bind("mouseleave",function(){e.find("li").removeClass("hover")}),s.on("click",function(){e.find("li").removeClass("selected"),e.addClass("valueSelected");for(var i=t(this).index()+1,s=1;i>=s;s++)e.find("li:nth-child("+s+")").addClass("selected");var l=e.find("input"),o=l.attr("name");l.val(i),a.addClass("validated").focus();var c=e.find("span");c.html(i+"/5"),n.store[o]=i,t("span.ch-"+o).html(i)})},reset:function(){var t=this.$elem.find(".rating");t.removeClass("valueSelected"),t.find("li").removeClass(),t.find("span").html("")}},date:{init:function(i){var e=this.stages["stage"+(this.stage-1)].datepicker,s=this;i.datepicker(e),i.on("change paste",function(){var i=t(this).val();s.plugins.date.validate.call(s,i)})},validate:function(t){var i=this.$elem.find("section:nth-of-type("+this.stage+")"),e=i.find(".ch-next"),s=/^(?:(?:(?:0?[13578]|1[02])(\/|-|\.)31)\1|(?:(?:0?[1,3-9]|1[0-2])(\/|-|\.)(?:29|30)\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:0?2(\/|-|\.)29\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:(?:0?[1-9])|(?:1[0-2]))(\/|-|\.)(?:0?[1-9]|1\d|2[0-8])\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/;s.test(t)?this.validations.makeValid(e):this.validations.makeInvalid(e)}}},send:function(){var i=this.$elem.find(".ch-sending"),e=this,s=function(t){i.addClass("show"),options.testMode&&setTimeout(function(){t()},2e3)},a=function(){var s;s=e.options.testMode?"Sent <i>(in test mode)</i>":"Sent",i.find("h2").html('<i class="el-icon-check"></i> '+s),setTimeout(function(){e.options.modal?(t(e.options.modalContainer).removeClass("open").addClass("close"),setTimeout(function(){t(e.options.modalContainer).removeClass("close"),resetForm()},400)):e.utilities.resetForm.call(e)},2e3)};return e.options.testMode?void s(function(){a()}):(s(),console.log(t("form[name="+e.options.formName+"]").serialize()),t.post(t("form[name="+e.options.formName+"]").attr("action"),t("form[name="+e.options.formName+"]").serialize(),function(t){"sent"===t?a():(i.removeClass("show"),setTimeout(function(){alert("Form sending timed out")},3e4))}),!1)},utilities:{init:function(){this.utilities.verticalAlign.call(this),this.utilities.responsive.call(this),this.utilities.changeTitle.call(this),this.utilities.initModal.call(this)},verticalAlign:function(){function e(e){function s(t){var i=t.height();t.css({"margin-top":"-"+i/2+"px"})}t(e).each(function(){s(t(this))}),t(i).resize(function(){t(e).each(function(){s(t(this))})})}var s=this.$elem.find(".section-padding");e(s)},responsive:function(){function e(){console.log(s.$elem);var i;i=s.options.modal?t(s.options.modalContainer):s.$elem,i.width()<=700?s.$elem.addClass("condensed"):s.$elem.removeClass("condensed")}var s=this;e(),t(i).resize(function(){e()})},changeTitle:function(){var t=this.$elem.find(".ch-title span"),i=this.$elem.find(".ch-counter span");1===this.stage?(t.html(this.options.welcomeTitle),i.html("-")):(t.html(this.stages["stage"+(this.stage-1)].title),i.html(this.stage-1+"/"+this.stagesLength))},initModal:function(){var i=this;console.log(i.options),i.options.modalFullScreen&&i.$elem.addClass("fullscreen"),t(e).on("click",i.options.modalOpenBtn,function(){t(i.options.modalContainer).addClass("open")}),i.$elem.find(".ch-close").on("click",function(){t(i.options.modalContainer).removeClass("open").addClass("close"),setTimeout(function(){t(i.options.modalContainer).removeClass("close"),i.utilities.resetForm.call(i)},400)})},resetForm:function(){t("form[name="+this.options.formName+"]")[0].reset(),this.$elem.find(".ch-next").each(function(){t(this).hasClass("skip")?t(this).html("Skip"):t(this).removeClass("validated")}),this.$elem.find("section").removeClass("after active"),this.$elem.find(".ch-sending").removeClass("show"),this.$elem.find("section:nth-of-type(1)").addClass("active"),this.$elem.find("section:nth-of-type(1) .ch-next").addClass("validated"),this.plugins.rating.reset.call(this),this.stage=1,this.utilities.changeTitle.call(this)},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}}},a.options=Plugin.prototype.options,t.fn.newChattaaar=function(t,i){return this.each(function(){new a(this,t,i).init()})}}(jQuery,window,document);
//# sourceMappingURL=./chattaaar-min.map