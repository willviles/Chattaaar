!function(e){e.fn.newChattaaar=function(t,n){function a(){var e='<div class="ch-title"><span>'+t.welcomeTitle+"</span></div>",n='<div class="ch-counter"><span>-</span></div>',a="",i="",s="",o="";t.modal&&(a='<div class="ch-close"><i class="el-icon-remove"></i></div>'),i='<div class="chattaaar-topbar">'+e+n+a+" </div>",S.append(i),t.modal&&(o=t.modalContainer,o=o.replace(/\./g,""),"undefined"!=typeof t.theme&&(s=" "+t.theme),S.wrap('<div class="chattaaar-modal '+o+s+'"></div>'))}function i(){var e="";"undefined"!=typeof t.welcomeImage&&(e='<div style="background-image: url('+t.welcomeImage+"); height: "+t.welcomeImageHeight+"; width: "+t.welcomeImageWidth+"; background-size: "+t.welcomeImageWidth+" "+t.welcomeImageHeight+';" class="welcome-image"></div>'),S.append('         <section class="welcome active">           <div class="section-padding">             '+e+"             <h2>"+t.welcomeText+"</h2>             <p>"+t.welcomeStrapline+'</p>             <div class="ch-next validated"><h4>'+t.startBtnText+"</h4></div>           </div>         </section>")}function s(e){var n,a;n=A===N.stagesLength?t.sendBtnText:B.skippable===!0?t.skipBtnText:t.nextBtnText,a=B.skippable===!0?'<button type="button" class="ch-next skip validated">'+n+"</button>":'<button type="button" class="ch-next">'+n+"</button>";var i='<div class="default-icon"><i class="el-icon-child"></i></div>',s="",o=i,c="",l=i;"undefined"!=typeof t.yourAvatar&&(o="",s=t.yourAvatar),"undefined"!=typeof t.theirAvatar&&(l="",c=t.theirAvatar);var d='<section>           <div class="section-padding">             <div class="question-container">               <div class="person-icon" style="background-image: url('+t.yourAvatar+');">                 '+o+'                 <span class="name"><small>'+t.yourName+"</small></span>               </div>               <p>                 <span>"+B.question+'</span>               </p>             </div>             <div class="action-container">               <div class="person-icon" style="background-image: url('+t.theirAvatar+');">                 '+l+'                 <span class="name"><small>'+t.theirName+'</small></span>               </div>               <div class="action-wrapper">'+e+'</div>               <div class="ch-btns-container">                 '+a+'                 <button type="button" class="ch-prev"><small><i class="el-icon-caret-up"></i></small> Prev</button>               </div>             </div>           </div>         </section>';return d}function o(t){var n,a="",i,o;if("media"===t){var c=B.accepts;console.log(c),e.each(c,function(e,t){a=a+" data-"+t+'="true"'}),t="text",n="ch-media"}"date"===t&&(t="text",n="ch-datepicker");var l='<input type="'+t+'" name="'+B.inputName+'" placeholder="'+B.placeholder+'" class="'+n+'" autocomplete="off"'+a+">";S.append(s(l))}function c(){var e='<textarea name="'+B.inputName+'" placeholder="'+B.placeholder+'"></textarea>';S.append(s(e))}function l(){var t="";e.each(B.options,function(e,n){var a="<option>"+n+"</option>";t+=a});var n='         <select type="text" name="'+B.inputName+'" placeholder="'+B.placeholder+'">           <option value="" disabled selected>'+B.placeholder+"</option>           "+t+"         </select>";S.append(s(n))}function d(){var t="";e.each(B.options,function(e,n){var a='           <label class="checkbox-radio">             <input type="'+B.type+'" name="'+B.inputName+'" value="'+n+'"/>             <span>               <i class="el-icon-check-empty"></i>               <i class="el-icon-edit"></i>               <i class="el-icon-check"></i>               '+n+"             </span>           </label>";t+=a}),t='<div class="checkbox-group">'+t+"</div>",S.append(s(t))}function r(){var e='<input type="hidden" name="'+B.inputName+'">',t='<li><i class="star el-icon-star"></i></li>',n='<span class="star-count"></span>',a='<ul class="rating rating-'+B.inputName+'">'+t+t+t+t+t+n+e+"</ul>";S.append(s(a))}function u(){console.log("Error: Stage #"+A+" has no valid 'type' set.")}function f(){var e=S.find(".rating");e.removeClass("valueSelected"),e.find("li").removeClass(),e.find("span").html("")}function h(){var t=S.find("section:nth-of-type("+N.stage+")"),n=t.find(".rating"),a=n.find("li"),i=t.find(".ch-next");a.unbind("mouseenter mouseleave").bind("mouseenter",function(){if(!n.hasClass("valueSelected")){n.find("li").removeClass("hover");for(var t=e(this).index(),a=1;t+1>=a;a++)n.find("li:nth-child("+a+")").addClass("hover")}}),n.unbind("mouseenter mouseleave").bind("mouseleave",function(){n.find("li").removeClass("hover")}),a.on("click",function(){n.find("li").removeClass("selected"),n.addClass("valueSelected");for(var t=e(this).index()+1,a=1;t>=a;a++)n.find("li:nth-child("+a+")").addClass("selected");var s=n.find("input"),o=s.attr("name");s.val(t),i.addClass("validated").focus();var c=n.find("span");c.html(t+"/5"),N.store[o]=t,e("span.ch-"+o).html(t)})}function p(t){function n(e){var t=e.height();e.css({"margin-top":"-"+t/2+"px"})}e(t).each(function(){n(e(this))}),e(window).resize(function(){e(t).each(function(){n(e(this))})})}function m(){function t(){r.hasClass("skip")?r.html("Next"):r.addClass("validated")}function n(){r.hasClass("skip")?r.html("Skip"):r.removeClass("validated")}function a(e){var a=/^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/;a.test(e)?t():n()}var i=S.find("section:nth-of-type("+N.stage+")"),s=i.find("input, textarea"),o=i.find("select"),c=i.find(".checkbox-group"),l=i.find(".rating"),d=i.find(".ch-datepicker"),r=i.find(".ch-next");if(s.keyup(function(){var i=e(this),o=i.attr("name"),c=i.val(),l=s.filter(function(){return""===e.trim(this.value)});if(l.length)n();else if("email"===i.attr("type")){var d=/^[A-Z0-9._%+-]+@([A-Z0-9-]+\.)+[A-Z]{2,4}$/i;d.test(c)?t():n()}else if(i.hasClass("ch-datepicker"))a(c);else if(i.hasClass("ch-media")){if(i.is("[data-youtube]")||i.is("[data-soundcloud]")){var r=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,u=/^https?:\/\/(soundcloud.com|snd.sc)\/(.*)$/;r.test(c)||u.test(c)?t():n()}}else t();N.store[o]=c,e("span.ch-"+o).html(c)}),o.each(function(){e(this).change(function(){t()})}),c.on("click",function(){var a=e(this).find("input:checked");a.length>0?t():n()}),l.length>0&&h(),d.length>0){var u=N.stages["stage"+(N.stage-1)].datepicker;d.datepicker(u),console.log(d),d.on("change paste",function(){a(e(this).val())})}}function v(){var e=S.find(".ch-title span"),n=S.find(".ch-counter span");1===N.stage?(e.html(t.welcomeTitle),n.html("-")):(e.html(N.stages["stage"+(N.stage-1)].title),n.html(N.stage-1+"/"+N.stagesLength))}function g(){function e(){I=!1,setTimeout(function(){I=!0},1e3)}var t=S.find("section:nth-of-type("+N.stage+")"),n=t.find("input"),a=t.find("textarea"),i=t.find("select"),s=t.find(".ch-next");a.length>0?n=a:i.length>0&&(n=i),n.length>0||a.length>0||i.length>0?(n.focus(),n.unbind("keydown").bind("keydown",function(t){I===!1&&t.preventDefault(),9===t.keyCode?(t.preventDefault(),s.hasClass("validated")&&s.focus()):13===t.keyCode&&I===!0&&(t.preventDefault(),C.call(s),n.blur(),s.blur(),e())}),s.bind("keydown",function(e){9===e.which&&(e.preventDefault(),n.focus())})):(s.focus(),s.unbind("keydown").bind("keydown",function(t){I===!1&&t.preventDefault(),13===t.keyCode&&I&&(t.preventDefault(),C.call(s),s.blur(),e())})),t.find(".checkbox-radio").on("click",function(){s.focus()})}function y(){var n=S.find(".ch-sending"),a=function(e){n.addClass("show"),t.testMode&&setTimeout(function(){e()},2e3)},i=function(){var a;a=t.testMode?"Sent <i>(in test mode)</i>":"Sent",n.find("h2").html('<i class="el-icon-check"></i> '+a),setTimeout(function(){t.modal?(e(t.modalContainer).removeClass("open").addClass("close"),setTimeout(function(){e(t.modalContainer).removeClass("close"),x()},400)):x()},2e3)};return t.testMode?void a(function(){i()}):(a(),e.post(e("form[name="+t.formName+"]").attr("action"),e("form[name="+t.formName+"]").serialize(),function(e){"sent"===e?i():(n.removeClass("show"),setTimeout(function(){alert("Form sending timed out")},3e4))}),!1)}function C(){this.hasClass("validated")&&(N.stage===N.stagesLength+1?y():(S.find("section:nth-of-type("+N.stage+")").removeClass("active").addClass("after"),S.find("section:nth-of-type("+(N.stage+1)+")").addClass("active"),N.stage++,v(),setTimeout(function(){g()},500),m()))}function k(){S.find("section:nth-of-type("+N.stage+")").removeClass("active"),S.find("section:nth-of-type("+(N.stage-1)+")").removeClass("after").addClass("active"),N.stage--,v(),setTimeout(function(){g()},500),m()}function b(){S.find(".ch-next").on("click",function(t){t.preventDefault(),C.call(e(this))}),S.find(".ch-prev").on("click",function(t){t.preventDefault(),k.call(e(this))})}function x(){e("form[name="+t.formName+"]")[0].reset(),S.find(".ch-next").each(function(){e(this).hasClass("skip")?e(this).html("Skip"):e(this).removeClass("validated")}),S.find("section").removeClass("after active"),S.find(".ch-sending").removeClass("show"),S.find("section:nth-of-type(1)").addClass("active"),S.find("section:nth-of-type(1) .ch-next").addClass("validated"),f(),N.stage=1,v()}function w(){t.modalFullScreen===!0&&S.addClass("fullscreen"),e(t.modalOpenBtn).on("click",function(){e(t.modalContainer).addClass("open")}),S.find(".ch-close").on("click",function(){e(t.modalContainer).removeClass("open").addClass("close"),setTimeout(function(){e(t.modalContainer).removeClass("close"),x()},400)})}function T(){var n;n=t.modal?e(t.modalContainer):S,n.width()<=700?S.addClass("condensed"):S.removeClass("condensed")}this.options=e.extend({formName:"form-"+(1+Math.floor(1e3*Math.random())),yourName:"Us",theirName:"You",welcomeTitle:'<i class="el-icon-envelope"></i>',welcomeText:"Welcome",welcomeStrapline:"Please add a strapline",startBtnText:"Start",nextBtnText:"Next",sendBtnText:"Send",skipBtnText:"Skip",modal:!1,modalOpenBtn:".chattaaar-open",modalContainer:".chattaaar-modal",modalFullScreen:!1,testMode:!1},t),t=this.options;var N=this,S=e(N);S.attr({name:t.formName,action:t.formAction}),"undefined"!=typeof t.theme&&S.addClass(t.theme),a(),this.store={},this.stage=1,this.stages=n,this.stagesLength=Object.keys(N.stages).length,i();for(var A=1;A<N.stagesLength+1;A++){var B=N.stages["stage"+A];"input"===B.type?o("text"):"email"===B.type?o("email"):"textarea"===B.type?c():"select"===B.type?l():"checkbox"===B.type||"radio"===B.type?d():"date"===B.type?o("date"):"rating"===B.type?r():"media"===B.type?o("media"):u(),N.store[B.inputName]=""}S.append('<div class="ch-sending"><h2 class="alert-text"><i class="el-icon-envelope"></i> Sending...</h2></div>'),b();var D=S.find(".section-padding");p(D);var I=!0;t.modal&&w(),T(),e(window).resize(function(){T()})}}(jQuery);
//# sourceMappingURL=./chattaaar-min.map